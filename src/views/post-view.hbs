{{#with posts}}
<div class="post card mb-3 border-0">
    <div class="post-header card-header d-flex align-items-center bg-white border-0">
        <a href="/{{username}}" class="me-3">
        <img src="{{avatar}}" alt="Avatar" class="avatar rounded-circle" style="width: 40px; height: 40px;">
        </a>
        <div class="post-info">
            <a href="/{{username}}" class="username text-dark">
                <div class="fw-bold">{{name}} ({{username}})</div>
            </a>
            <div class="timestamp text-muted small">{{timestamp}}</div>
        </div>
    </div>
    <div class="post-description card-body">
        {{description}}
    </div>
    <div class="post-images d-flex overflow-hidden gap-2 pe-3">
        {{#each imagePath}}
            <img src="{{this}}" draggable="false" alt="Image" class="post-image rounded">
        {{/each}}
    </div>
    <div class="post-actions card-footer d-flex bg-white border-0">
        <span class="action like me-3 d-flex align-items-center pe-2 ps-2" data-post-id="{{postId}}">
            <i class="bi {{#if isLiked}}bi-heart-fill{{else}}bi-heart{{/if}} fs-6 me-2 ms-1 like-icon"></i>
            <span class="like-count">{{likeCount}}</span>
        </span>
        <span class="action comment d-flex align-items-center pe-2 ps-2">
            <i class="bi bi-chat-left fs-6 me-2 ms-1"></i>
            {{commentCount}}
        </span>
    </div>

    <!-- Comment input -->
    <div class="comment-input-section mt-3 p-3 bg-light rounded d-flex align-items-center position-relative">
        <textarea id="comment-input" class="form-control me-2" placeholder="Add a comment..." rows="1" maxlength="255"></textarea>
        <button id="send-comment" class="btn btn-dark btn-primary ms-2 mt-3 rounded-circle d-flex justify-content-center" data-post-id="{{postId}}" style="width: 38px; height: 38px;">
            <i class="bi bi-send-fill"></i>
        </button>
        <small id="char-count" class="text-muted position-absolute bottom-0 end-0 me-2 mb-1">0/255</small>
    </div>
    <small id="char-warning" class="text-danger mt-1" style="display: none;">Comment is too long!</small>

    <div id="post-comments" class="mt-3">
        {{#each comments}}
        <div class="commentSection p-3 mb-2">
            <div class="comment-header d-flex align-items-center mb-1">
                <a href="/{{username}}" class="me-2">
                    <img src="{{avatar}}" alt="Avatar" class="comment-avatar rounded-circle" style="width: 40px; height: 40px;">
                </a>
                <div class="comment-info">
                    <a href="/{{username}}" class="username text-dark">
                        <span class="comment-username fw-bold">{{fullname}} ({{username}})</span>
                    </a>
                    <span class="comment-timestamp text-muted small">{{timestamp}}</span>
                </div>
            </div>
            <div class="comment-text">
                {{text}}
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/with}}

<style>
    .comment-input-section textarea {
        resize: none;
        overflow: hidden;
        min-height: 38px;
    }

    .comment-avatar {
        object-fit: cover;
    }

    #send-comment {
        position: relative;
        right: 10px;
        bottom: 10px;
    }

    .comment-text {
        margin-left: 3.65rem;
    }

    @keyframes shake {
        0% { transform: translateX(0); }
        25% { transform: translateX(-2px); }
        50% { transform: translateX(2px); }
        75% { transform: translateX(-2px); }
        100% { transform: translateX(0); }
    }

    .shake {
        animation: shake 0.3s ease-in-out;
    }

    .text-danger {
        color: red !important;
    }
</style>

